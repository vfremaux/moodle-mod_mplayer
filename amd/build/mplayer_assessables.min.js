define(["jquery","core/log","core/config"],function(a,b,c){var d={ismarking:!1,currentzone:null,startpoint:0,startpointtime:0,endpoint:0,endpointtime:0,init:function(){a(".mplayer-bumper").bind("click",this.bump_in),a(".mplayer-punchinout").bind("click",this.start_marking),b.debug("AMD Mplayer Asessables initialized")},start_marking:function(){var b=a(this),c=b.attr("id").replace("mplayer-punchinout-",""),e=a("#flp"+c),f=e.attr("class"),g=f.match(/video([0-9]+)/),h=0+parseInt(g[1]),i=" .mod-mplayer-progressbar-outer .progressbar-segment.newzone",j=a("#mplayer-progress-"+c+"_"+h+i),k=0;a(j).removeClass("is-hidden"),a(j).css("left",k+"%"),d.currentzone=j,d.ismarking=!0,a("#mplayer-punchinout-"+c).attr("value","Stop marking zone"),a("#mplayer-punchinout-"+c).css("background-color","red"),a("#mplayer-punchinout-"+c).css("color","white"),a("#mplayer-punchinout-"+c).off("click"),a("#mplayer-punchinout-"+c).bind("click",d.stop_marking),a("#mplayer-punchinout-"+c).addClass("is-marking")},stop_marking:function(){var b=a(this),e=b.attr("id").replace("mplayer-punchinout-",""),f=a("#flp"+e),g=f.attr("class"),h=g.match(/video([0-9]+)/),i=0+parseInt(h[1]);a("#mplayer-punchinout-"+e).attr("value","Start marking zone"),a("#mplayer-punchinout-"+e).css("background-color","initial"),a("#mplayer-punchinout-"+e).css("color","black");var j=c.wwwroot+"/mod/mplayer/pro/ajax/services.php?";j+="what=addzone",j+="&mplayerid="+e,j+="&clipid="+i,j+="&startpoint="+d.startpoint,j+="&endpoint="+d.endpoint,j+="&startpointtime="+d.startpointtime,j+="&endpointtime="+d.endpointtime,a.get(j,function(){},"json");var k=" .mod-mplayer-progressbar-outer .progressbar-segment.newzone",l=a("#mplayer-progress-"+e+"_"+i+k);l.addClass("is-hidden"),d.ismarking=!1,d.startpoint=d.endpoint,a("#mplayer-punchinout-"+e).off("click"),a("#mplayer-punchinout-"+e).bind("click",d.start_marking),a("#mplayer-punchinout-"+e).removeClass("is-marking")},delete_zone:function(){var b=a(this),d=b.attr("data-zone").split("-"),e=d[0],f=d[1],g=d[2],h=c.wwwroot+"/mod/mplayer/pro/ajax/services.php?";h+="&what=deletezone",h+="&mplayerid="+e,h+="&clipid="+f,h+="&zoneid="+g,a.get(h,function(){a("body").remove("#"+b.attr("id"))},"json")},bump_in:function(){var b=a(this),e=b.attr("id").replace("mplayer-bumper-",""),f=a("#flp"+e),g=f.attr("class"),h=g.match(/video([0-9]+)/),i=0+parseInt(h[1]),j=c.wwwroot+"/mod/mplayer/pro/ajax/services.php?";j+="what=bumpzone",j+="&mplayerid="+e,j+="&clipid="+i,j+="&progress="+d.startpoint,j+="&progresstime="+d.startpointtime,a.get(j,function(b){"true"==b.matched&&(a("#mplayer-progress-"+b.mpid+"_"+b.index).html(b.progressbar),a("#mplayer-assess-counts-"+b.mpid+"_"+b.index).html(b.counter))},"json")}};return window.modmplayerassessables=d,d});
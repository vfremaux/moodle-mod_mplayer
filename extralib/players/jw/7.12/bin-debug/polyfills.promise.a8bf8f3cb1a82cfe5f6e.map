{"version":3,"sources":["webpack:///./src/js/polyfills/promise.js"],"names":["_","asap","defer","bind","fn","thisArg","apply","arguments","isArray","Array","value","Object","prototype","toString","call","PromisePolyfill","TypeError","_state","_value","_deferreds","doResolve","resolvePolyfill","rejectPolyfill","handle","deferred","me","push","cb","onFulfilled","onRejected","resolve","reject","ret","e","newValue","then","finale","i","len","length","Handler","done","reason","ex","all","args","slice","remaining","res","val","val2","constructor","race","values","_setImmediateFn","window","Promise"],"mappings":"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","file":"polyfills.promise.js","sourcesContent":["define(['utils/underscore'], function(_) {\n    // https://github.com/taylorhakes/promise-polyfill\n    // v2.1.0\n\n    // ** THIS POLYFILL BREAKS WEBPACK **\n    // Use polyfill for setImmediate for performance gains\n    // var asap = (typeof setImmediate === 'function' && setImmediate) ||\n        // function(fn) { setTimeout(fn, 1); };\n    var asap = _.defer;\n\n    // Polyfill for Function.prototype.bind\n    function bind(fn, thisArg) {\n        return function() {\n            fn.apply(thisArg, arguments);\n        };\n    }\n\n    var isArray = Array.isArray || function(value) {\n        return Object.prototype.toString.call(value) === '[object Array]';\n    };\n\n    function PromisePolyfill(fn) {\n        if (typeof this !== 'object') {\n            throw new TypeError('Promises must be constructed via new');\n        }\n        if (typeof fn !== 'function') {\n            throw new TypeError('not a function');\n        }\n        this._state = null;\n        this._value = null;\n        this._deferreds = [];\n\n        doResolve(fn, bind(resolvePolyfill, this), bind(rejectPolyfill, this));\n    }\n\n    function handle(deferred) {\n        var me = this;\n        if (this._state === null) {\n            this._deferreds.push(deferred);\n            return;\n        }\n        asap(function () {\n            var cb = me._state ? deferred.onFulfilled : deferred.onRejected;\n            if (cb === null) {\n                (me._state ? deferred.resolve : deferred.reject)(me._value);\n                return;\n            }\n            var ret;\n            try {\n                ret = cb(me._value);\n            } catch (e) {\n                deferred.reject(e);\n                return;\n            }\n            deferred.resolve(ret);\n        });\n    }\n\n    function resolvePolyfill(newValue) {\n        try { // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n            if (newValue === this) {\n                throw new TypeError('A promise cannot be resolved with itself.');\n            }\n            if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                var then = newValue.then;\n                if (typeof then === 'function') {\n                    doResolve(bind(then, newValue), bind(resolvePolyfill, this), bind(rejectPolyfill, this));\n                    return;\n                }\n            }\n            this._state = true;\n            this._value = newValue;\n            finale.call(this);\n        } catch (e) {\n            rejectPolyfill.call(this, e);\n        }\n    }\n\n    function rejectPolyfill(newValue) {\n        this._state = false;\n        this._value = newValue;\n        finale.call(this);\n    }\n\n    function finale() {\n        for (var i = 0, len = this._deferreds.length; i < len; i++) {\n            handle.call(this, this._deferreds[i]);\n        }\n        this._deferreds = null;\n    }\n\n    function Handler(onFulfilled, onRejected, resolve, reject) {\n        this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n        this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n        this.resolve = resolve;\n        this.reject = reject;\n    }\n\n    function doResolve(fn, onFulfilled, onRejected) {\n        var done = false;\n        try {\n            fn(function (value) {\n                if (done) {\n                    return;\n                }\n                done = true;\n                onFulfilled(value);\n            }, function (reason) {\n                if (done) {\n                    return;\n                }\n                done = true;\n                onRejected(reason);\n            });\n        } catch (ex) {\n            if (done) {\n                return;\n            }\n            done = true;\n            onRejected(ex);\n        }\n    }\n\n    /* eslint dot-notation: 0 */\n    PromisePolyfill.prototype['catch'] = function (onRejected) {\n        return this.then(null, onRejected);\n    };\n\n    PromisePolyfill.prototype.then = function (onFulfilled, onRejected) {\n        var me = this;\n        return new PromisePolyfill(function (resolve, reject) {\n            handle.call(me, new Handler(onFulfilled, onRejected, resolve, reject));\n        });\n    };\n\n    PromisePolyfill.all = function () {\n        var args = Array.prototype.slice.call(arguments.length === 1 && isArray(arguments[0]) ? arguments[0] : arguments);\n\n        return new PromisePolyfill(function (resolve, reject) {\n            if (args.length === 0) {\n                return resolve([]);\n            }\n            var remaining = args.length;\n\n            function res(i, val) {\n                try {\n                    if (val && (typeof val === 'object' || typeof val === 'function')) {\n                        var then = val.then;\n                        if (typeof then === 'function') {\n                            then.call(val, function (val2) {\n                                res(i, val2);\n                            }, reject);\n                            return;\n                        }\n                    }\n                    args[i] = val;\n                    if (--remaining === 0) {\n                        resolve(args);\n                    }\n                } catch (ex) {\n                    reject(ex);\n                }\n            }\n\n            for (var i = 0; i < args.length; i++) {\n                res(i, args[i]);\n            }\n        });\n    };\n\n    PromisePolyfill.resolve = function (value) {\n        if (value && typeof value === 'object' && value.constructor === PromisePolyfill) {\n            return value;\n        }\n\n        return new PromisePolyfill(function (resolve) {\n            resolve(value);\n        });\n    };\n\n    PromisePolyfill.reject = function (value) {\n        return new PromisePolyfill(function (resolve, reject) {\n            reject(value);\n        });\n    };\n\n    PromisePolyfill.race = function (values) {\n        return new PromisePolyfill(function (resolve, reject) {\n            for (var i = 0, len = values.length; i < len; i++) {\n                values[i].then(resolve, reject);\n            }\n        });\n    };\n\n    PromisePolyfill._setImmediateFn = function _setImmediateFn(fn) {\n        asap = fn;\n    };\n\n    /* eslint no-unused-expressions: 0 */\n    window.Promise || (window.Promise = PromisePolyfill);\n\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/polyfills/promise.js\n **/"],"sourceRoot":""}